Finally cleaning up my old direct-assignment sampling code... Check back later
